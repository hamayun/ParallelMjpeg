<?xml version="1.0" encoding="UTF-8"?>

<component author="xavier.guerin@imag.fr" unique="true" wrapper="false">

  <id name="MjpegApplication" short_name="MJPEG" version="1.0"/>

  <inject>
    <id name="SoclibPlatformDriver" version="1.0"/>
    <id name="SoclibFramebufferDriver" version="1.0"/>
    <id name="SoclibHostAccess" version="1.0"/>
    <id name="RendezVousChannelDriver" version="1.0"/>
    <id name="DeviceFileSystem" version="1.0"/>
    <id name="RootFileSystem" version="1.0"/>
  </inject>

  <restrict>
    <id name="ArmV6Processor" version="1.0"/>
    <id name="DnaCore" version="1.0"/>
    <id name="DnaMM-WorstFit" version="1.0"/>
    <id name="PosixThreadsLibrary" version="1.0"/>
  </restrict>

  <provide>
    <method name="main" return_type="int32_t">
      <argument name="argc" type="int32_t" direction="in"/>
      <argument name="argv" type="array of string" direction="in"/>
    </method>
  </provide>

  <require>

    <!-- C library hooks -->

    <method name="printf" return_type="int32_t">
      <argument name="format" type="string" direction="in"/>
      <argument name="..." type="array of void" direction="in"/>
    </method>

    <!-- kpn_channel_thooks -->

    <type name="kpn_channel_t"/>
    <type name="kpn_status_t"/>

    <method name="kpn_channel_create" return_type="kpn_status_t">
      <argument name="name" type="string" direction="in"/>
      <argument name="size" type="int32_t" direction="in"/>
      <argument name="channel" type="kpn_channel_t" direction="out"/>
    </method>
 
    <method name="kpn_channel_read" return_type="kpn_status_t">
      <argument name="channel" type="kpn_channel_t" direction="in"/>
      <argument name="buffer" type="access" direction="in"/>
      <argument name="size" type="uint32_t" direction="in"/>
    </method>

    <method name="kpn_channel_write" return_type="kpn_status_t">
      <argument name="channel" type="kpn_channel_t" direction="in"/>
      <argument name="buffer" type="access" direction="in"/>
      <argument name="size" type="uint32_t" direction="in"/>
    </method>

    <!-- Pthreads hooks -->

    <method name="pthread_create" return_type="int32_t">
      <argument name="thread" type="pthread_t" direction="out"/>
      <argument name="attrs" type="pthread_attr_t" direction="inout"/>
      <argument name="func" type="pthread_func_t" direction="in"/>
      <argument name="args" type="access" direction="in"/>
    </method>

    <!-- Host access hooks -->

    <definition name="fdaccess_requests"/>
 
  </require>

</component>
